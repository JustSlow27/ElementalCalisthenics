/* =========================
   Reset & contención
========================= */
*, *::before, *::after { box-sizing: border-box; }
html, body { width:100%; max-width:100%; margin:0; overflow-x:hidden; }

/* Contenedor global centrado */
.shell{
  max-inline-size:1200px;            /* ajusta si quieres más ancho */
  margin-inline:auto;
  padding-inline:clamp(8px,2vw,24px);
}

/* =========================
   Header
========================= */
.header-bar{
  color:#fff;
  padding:18px 20px;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:12px;
}
.header-bar h1{ margin:0; font-size:1.25rem; font-weight:800; }
.usuario-mini{ font-weight:700; }

/* =========================
   Contenedor principal
========================= */
.container{
  inline-size:100%;
  max-inline-size:100%;
  background:#fff;
  color:var(--text);
  border:var(--border);
  border-radius:var(--radius);
  margin:16px 20px 24px;
  padding:clamp(16px,2vw,24px);
  box-shadow:var(--shadow);
  display:grid;
  gap:22px;
  min-height:0;                 /* permite scroll interno */
}
.container > *{ min-width:0; min-height:0; }

/* =========================
   Paneles
========================= */
.panel{
  border:1px solid #e5e7eb;
  border-radius:14px;
  padding:16px;
  background:#fafafa;
  max-width:100%;
  min-height:0;
}
.panel-head{
  display:flex;
  align-items:baseline;
  gap:10px;
  margin-bottom:12px;
}
.panel-head h2{ margin:0; font-size:1.1rem; }
.help{ color:#6b7280; font-size:.9rem; }

/* =========================
   Agendamiento
========================= */
.agenda-grid{
  display:grid;
  grid-template-columns:repeat(4,minmax(180px,1fr));
  gap:12px 16px;
  align-items:start;
}
.campo{ display:flex; flex-direction:column; gap:8px; }
.campo.campo-dia{
  display:flex; flex-direction:row; align-items:center;
  gap:.35rem; justify-self:start; margin-bottom:2px;
}
.dia-label{ font-weight:800; color:#374151; }
.dia-activo{
  text-transform:capitalize; font-weight:700;
  padding:3px 10px; border-radius:999px; background:#e0f2fe; color:#0284c7;
}
.campo-horarios{ margin-top:0; }

/* Tarjetas de horarios */
.checklist{
  display:grid; gap:10px;
  max-height:clamp(240px,42vh,480px);
  overflow:auto; padding-right:6px; overscroll-behavior:contain;
  scrollbar-width:thin;
  scrollbar-color:color-mix(in srgb, var(--color-botones) 45%, #93c5fd) #f3f4f6;
}
.checklist::-webkit-scrollbar{ width:10px; }
.checklist::-webkit-scrollbar-track{ background:#f3f4f6; border-radius:999px; }
.checklist::-webkit-scrollbar-thumb{
  background:color-mix(in srgb, var(--color-botones) 45%, #93c5fd);
  border-radius:999px;
}
.checklist::-webkit-scrollbar-thumb:hover{
  background:color-mix(in srgb, var(--color-botones) 65%, #60a5fa);
}

label.check{
  --bg:#fff; --bd:#e5e7eb; --tx:#111; --ring:var(--color-botones);
  display:flex; align-items:center; justify-content:space-between; gap:12px;
  padding:12px 14px; border:1.5px solid var(--bd); border-radius:14px;
  background:var(--bg); color:var(--tx); cursor:pointer; transition:.18s ease;
  box-shadow:0 1px 2px rgba(0,0,0,.04);
  min-height:48px;
}
label.check:hover{ transform:translateY(-1px); box-shadow:0 4px 14px rgba(0,0,0,.06); }
label.check.selected{
  border-color:var(--ring);
  box-shadow:0 0 0 3px color-mix(in oklab, var(--ring) 22%, transparent);
}
label.check.disabled{ opacity:.5; cursor:not-allowed; filter:grayscale(.1); }
label.check input[type="radio"]{ position:absolute; opacity:0; pointer-events:none; }
label.check .dot{
  width:18px; height:18px; border-radius:999px; border:2px solid #9ca3af; flex:0 0 auto;
  display:inline-block; position:relative;
}
label.check.selected .dot{ border-color:var(--ring); }
label.check.selected .dot::after{ content:""; position:absolute; inset:3px; border-radius:999px; background:var(--ring); }

.check-left{ display:flex; align-items:center; gap:10px; }
.tx{ font-weight:700; letter-spacing:.2px; }
.badge-disp{ font-size:.75rem; font-weight:700; padding:3px 8px; border-radius:999px; color:#fff; }
.badge-libre{ background:#16a34a; } .badge-medias{ background:#f59e0b; } .badge-llena{ background:#dc2626; }
.cap{ color:#6b7280; font-size:.9rem; }

/* Lista de agendamientos */
.agenda-lista{ margin-top:12px; }
.agenda-lista h3{ margin:0 0 8px; font-size:1rem; }
#listaAgendamientos{ list-style:none; margin:0; padding:0; display:grid; gap:6px; }
#listaAgendamientos li{ background:#fff; border:1px solid #e5e7eb; border-radius:10px; padding:10px 12px; }

/* =========================
   Rutina semanal
========================= */
.rutina-tabs{ display:flex; gap:8px; flex-wrap:wrap; margin-bottom:10px; }
.tab{
  background:transparent; color:var(--color-botones);
  border:2px solid var(--color-botones);
  padding:8px 12px; border-radius:999px; font-weight:700; cursor:pointer;
}
.tab.active, .tab:hover{ background:var(--color-botones); color:#fff; }

/* Contenedor scrolleable de la tabla (vertical + horizontal) */
.tabla-wrapper{
  position:relative;                       /* mejora stacking de sticky */
  display:block;
  height:clamp(300px,50vh,560px);          /* ← fuerza scroll vertical */
  overflow-y:auto;                         /* vertical */
  overflow-x:auto;                         /* horizontal */
  border:1px solid #e5e7eb;
  border-radius:12px;
  background:#fff;
  -webkit-overflow-scrolling:touch;
  overscroll-behavior:contain;
  scrollbar-width:thin;
  scrollbar-color:color-mix(in srgb, var(--color-botones) 45%, #93c5fd) #f3f4f6;
}
.tabla-wrapper::-webkit-scrollbar{ height:10px; width:10px; }
.tabla-wrapper::-webkit-scrollbar-track{ background:#f3f4f6; border-radius:999px; }
.tabla-wrapper::-webkit-scrollbar-thumb{
  background:color-mix(in srgb, var(--color-botones) 45%, #93c5fd);
  border-radius:999px;
}
.tabla-wrapper::-webkit-scrollbar-thumb:hover{
  background:color-mix(in srgb, var(--color-botones) 65%, #60a5fa);
}

/* Tabla */
#tablaRutinaUsuario{
  width:100%;
  border-collapse:collapse;
  table-layout:auto;
  min-width:980px;                         /* provoca scroll horizontal si no cabe */
}
#tablaRutinaUsuario th,
#tablaRutinaUsuario td{
  min-width:140px;
  white-space:nowrap;                      /* favorece el scroll horizontal */
  padding:10px 12px;
  border-top:1px solid #eee;
}

/* ===== THEAD doble fila fijo ===== */
:root { --thead1-h: 1px; }  /* ajusta 40–48px si cambia la altura real */

/* Base del thead para ambas filas */
#tablaRutinaUsuario thead th{
  position: sticky;
  background: var(--color-primario, #3b82f6);
  color: #fff;
  text-align: left;
  z-index: 2;
  padding: 10px 12px;
  line-height: 1.2;
  box-shadow: none;                 /* ← sin líneas por defecto */
}

/* 1ª fila (días): fija arriba y SIN línea inferior (para no dividir) */
#theadDias th{
  top: 0;
  z-index: 5;
  box-shadow: none;                 /* ← quita la separadora entre filas */
}

/* 2ª fila (subtítulos): fija debajo; solo línea INFERIOR hacia el tbody */
#theadSub th{
  top: var(--thead1-h);
  z-index: 4;
  box-shadow: 0 1px 0 rgba(0,0,0,.12);  /* ← sutil línea bajo el thead */
}

/* Área scrolleable para sticky (refuerzo de altura y scroll) */
.tabla-wrapper{
  position: relative;
  display: block;
  height: clamp(300px, 50vh, 560px);
  overflow-y: auto;
  overflow-x: auto;
}

/* =========================
   Botones
========================= */
.btn-primary{
  background:var(--color-botones); color:#fff; border:none;
  padding:10px 16px; border-radius:10px; font-weight:700; cursor:pointer;
}
.btn-secondary{
  background:transparent; color:var(--color-botones); border:2px solid var(--color-botones);
  padding:10px 16px; border-radius:10px; font-weight:700; cursor:pointer;
}

/* =========================
   Modal
========================= */
.eg-modal{ position:fixed; inset:0; display:none; z-index:1000; }
.eg-modal.eg-open{ display:block; }
.eg-modal__backdrop{ position:absolute; inset:0; background:#000; opacity:.45; }
.eg-modal__dialog{
  position:relative; z-index:1; max-width:560px; margin:10vh auto; background:var(--bg,#fff);
  color:var(--fg,#111); border-radius:16px; box-shadow:0 10px 30px rgba(0,0,0,.2);
  padding:24px 28px; outline:0;
}
.eg-modal__title{ margin:0 0 10px; font-size:1.2rem; font-weight:700; }
.eg-modal__desc{ margin:0; line-height:1.5; }
.eg-modal__close{
  position:absolute; top:8px; right:10px; border:0; background:transparent; cursor:pointer;
  font-size:24px; line-height:1; color:inherit; padding:6px; border-radius:8px;
}
.eg-modal__close:hover{ background:rgba(0,0,0,.06); }
.btn-info{ margin-left:.4rem; border:0; background:transparent; cursor:pointer; font-size:1rem; }
.btn-info:focus{ outline:2px solid var(--color-primario,#3b82f6); outline-offset:2px; }

/* =========================
   Branding cabecera
========================= */
.user-info{ font-weight:700; }
.logo-area{ justify-self:center; text-align:center; }
.logo{
  max-height:64px; width:64px; object-fit:contain; display:block; margin:0 auto 6px;
  background:rgba(255,255,255,.06); border-radius:12px;
}

/* =========================
   Responsive (tus reglas base)
========================= */
@media (max-width:1100px){ .agenda-grid{ grid-template-columns:1fr 1fr; } }
@media (max-width:700px){
  .agenda-grid{ grid-template-columns:1fr; }
  .acciones{ flex-direction:column; justify-content:stretch; }
  #tablaRutinaUsuario th, #tablaRutinaUsuario td{ min-width:120px; }
}
@media (min-height:900px){
  .checklist{ max-height:520px; }
  .tabla-wrapper{ height:620px; } /* más alto si la pantalla es grande */
}

/* =========================
   Overrides responsive SIN cambiar tu interfaz
   (añadidos para móvil y tablet)
========================= */

/* Teléfonos ≤ 640px */
@media (max-width: 640px) {
  .shell { padding-inline: 12px; }

  /* Header apilado y centrado */
  .header-bar {
    flex-direction: column;
    align-items: center;
    text-align: center;
    gap: 10px;
  }
  .logo { width: 56px; max-height: 56px; }

  /* Contenedor y paneles más compactos */
  .container { margin: 12px 0 16px; padding: 14px; }
  .panel { padding: 12px; }
  .panel-head { flex-direction: column; align-items: flex-start; gap: 6px; }
  .help { font-size: .85rem; }

  /* Agenda: 1 columna (sin tocar tu estructura) */
  .agenda-grid {
    grid-template-columns: 1fr !important;
    gap: 10px;
  }
  .campo.campo-dia { flex-wrap: wrap; }

  /* Scrolls más contenidos en móvil */
  .checklist { max-height: 45vh; }
  .tabla-wrapper { height: 50vh; }

  /* Tabla: mantener scroll horizontal pero más compacta */
  #tablaRutinaUsuario { min-width: 720px; } /* antes 980px */
  #tablaRutinaUsuario th,
  #tablaRutinaUsuario td {
    min-width: 110px;          /* antes 140px */
    padding: 8px 10px;         /* ligeramente menor */
  }

  /* Altura de la 1ª fila sticky del thead (ajústala si tu cabecera es más alta) */
  :root { --thead1-h: 36px; }
}

/* Tablets 641–900px */
@media (min-width: 641px) and (max-width: 900px) {
  .agenda-grid { grid-template-columns: 1fr 1fr; }
  .tabla-wrapper { height: 60vh; }

  /* Un poco más de ancho mínimo de tabla en tablet */
  #tablaRutinaUsuario { min-width: 900px; }
  #tablaRutinaUsuario th,
  #tablaRutinaUsuario td { min-width: 120px; }
}

/* Pantallas con poca altura (p.ej. móviles apaisados) */
@media (max-height: 640px) {
  .tabla-wrapper { height: 55vh; }
  .checklist { max-height: 40vh; }
}
